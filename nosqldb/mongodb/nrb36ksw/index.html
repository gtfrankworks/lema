<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.160" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><link rel="icon" type="image/jpeg" href="kclm2.png"><title>MongoDB学习笔记</title><meta name="description" content="乐码职说"><link rel="preload" href="/lema/assets/style-CozHigQ-.css" as="style"><link rel="stylesheet" href="/lema/assets/style-CozHigQ-.css"><link rel="modulepreload" href="/lema/assets/app-ZQgO6-gU.js"><link rel="modulepreload" href="/lema/assets/index.html-C9Epu_8u.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-d90a7a26><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-d90a7a26 data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title has-sidebar" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link link no-icon title" href="/lema/" data-v-1a4f50af><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/lema/kclm.jpg" alt data-v-480e858a><!--]--><!--[--><img class="vp-image light logo" style="" src="/lema/kclm.jpg" alt data-v-480e858a><!--]--><!--]--><!--]--><span data-v-1a4f50af></span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/lema/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>首页</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>面试锦囊</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>直通无忧陪跑</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/interview/" data-v-1ff1855f><!--[--><!----> 面试常见面问题 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->软技能<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/bigcompany/" data-v-1ff1855f><!--[--><!----> 面试题实战准备 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->硬核实力<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/lema/blog/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>就业资讯</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>工具资源</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>Git基础知识和使用指南</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/tools/git/" data-v-1ff1855f><!--[--><!----> Git基础知识 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->核心<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/tools/maven/" data-v-1ff1855f><!--[--><!----> Maven操作指南 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->工具<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>项目中常见的工具</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/tools/project/" data-v-1ff1855f><!--[--><!----> 项目常用的工具 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->核心<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>Java知识</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>Java知识汇总</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/java-tutorial/xz6gi9o3/" data-v-1ff1855f><!--[--><!----> Java的技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->核心<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/design/" data-v-1ff1855f><!--[--><!----> Java中常用的设计模式 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->重点<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>开源框架</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>Spring体系技术</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/spring/" data-v-1ff1855f><!--[--><!----> Spring框架技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->核心<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/springboot/lt8adhak/" data-v-1ff1855f><!--[--><!----> SpringBoot框架技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->重点<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/spring/" data-v-1ff1855f><!--[--><!----> SpringCloud体系技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->重点<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>SpringAI体系技术</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/spring/" data-v-1ff1855f><!--[--><!----> SpringAI技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->未来<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>ORM框架技术</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/mybatis/" data-v-1ff1855f><!--[--><!----> MyBatis框架技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->核心<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/framework/mybatisflex/" data-v-1ff1855f><!--[--><!----> MyBatisFlex框架技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->未来<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>数据库</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>数据库基础和原理</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/db/base/" data-v-1ff1855f><!--[--><!----> MySQL数据库 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->关系数据库<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/PostgreSQL/" data-v-1ff1855f><!--[--><!----> PostgreSQL数据库 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->NoSQl数据库<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>NoSQL数据库技术</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/nosqldb/redises/v8rkaugl/" data-v-1ff1855f><!--[--><!----> NoSQL数据库 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->NoSQl数据库<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>AI相关技术</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-group" data-v-709dc2b1 data-v-c497e9e3><p class="title" data-v-c497e9e3><!----><span data-v-c497e9e3>智能体发展</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/ai/agent/8puzeqeb/" data-v-1ff1855f><!--[--><!----> 智能体技术 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->趋势<!--]--></span><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-c497e9e3 data-v-1ff1855f><a class="vp-link link" href="/lema/ai/p9n8jqdf/" data-v-1ff1855f><!--[--><!----> 智能体项目案例 <span class="vp-badge tip vp-menu-badge" style="" data-v-1ff1855f data-v-12255704><!--[-->趋势<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/lema/introd/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>关于我们</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-2c31ea5e data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>外观</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-d90a7a26 data-v-3944d8e8><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-d90a7a26 data-v-95211354><div class="curtain" data-v-95211354></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-95211354><span id="sidebar-aria-label" class="visually-hidden" data-v-95211354> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>Redis学习指南</span><span class="vp-badge danger vp-menu-badge" style="" data-v-12048f0f data-v-12255704><!--[-->理解<!--]--></span></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/redises/hmhrcnk1/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis入门概述</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/89m7lvl/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis安装配置</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/redises/1gjl58nl/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis的10大数据类型</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/redises/qbr291jr/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis持久化详解</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/fw6n7ai8/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis的事务机制</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/rdoy93y7/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis管道介绍</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mhwtbwr0/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis发布订阅</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/t9mr66aj/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis的复制介绍</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/uw7wxsph/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis哨兵模式</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/apr45ujb/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis集群模式</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/z5tlt4gj/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Redis实战练习</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-473fd05b data-v-12048f0f><div class="item" role="button" tabindex="0" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><h2 class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB资料</span><span class="vp-badge danger vp-menu-badge" style="" data-v-12048f0f data-v-12255704><!--[-->理解<!--]--></span></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-12048f0f><span class="vpi-chevron-right caret-icon" data-v-12048f0f></span></div></div><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mongodb/nrb36ksw/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB的介绍和安装</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mongodb/p418al5x/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB聚合查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mongodb/axtf7ye7/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB运算命令</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mongodb/viqmgx77/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB事务开发</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/lema/nosqldb/mongodb/MongoDB%E6%96%87%E6%A1%A3%E6%A8%A1%E5%9E%8B%E8%AE%BE%E8%AE%A1/2juizrnj/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>MongoDB文档模型</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-d90a7a26 data-v-b2beaca7><div class="vp-doc-container has-sidebar has-aside" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><div class="aside" vp-outline data-v-23f6ad98><div class="aside-curtain" data-v-23f6ad98></div><div class="aside-container" data-v-23f6ad98><div class="aside-content" data-v-23f6ad98><div class="vp-doc-aside" data-v-23f6ad98 data-v-5976474c><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-5976474c data-v-aa56eba0><div class="content" data-v-aa56eba0><div class="outline-marker" data-v-aa56eba0></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-aa56eba0><span data-v-aa56eba0>此页内容</span><span class="vpi-print icon" data-v-aa56eba0></span></div><ul class="root" data-v-aa56eba0 data-v-3e6b023c><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5976474c></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/lema/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="首页" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->MongoDB资料<!--]--><!----></span><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="MongoDB资料" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb current" href="/lema/nosqldb/mongodb/nrb36ksw/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->MongoDB学习笔记<!--]--><!----></a><!----><meta property="name" content="MongoDB学习笔记" data-v-1ae4ad7a><meta property="position" content="3" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-ba8d1a1e><!----> MongoDB学习笔记 <!----></h1><div class="vp-doc-meta" data-v-ba8d1a1e><!--[--><!--]--><p class="reading-time" data-v-ba8d1a1e><span class="vpi-books icon" data-v-ba8d1a1e></span><span data-v-ba8d1a1e>约 7291 字</span><span data-v-ba8d1a1e>大约 24 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-ba8d1a1e><span class="vpi-clock icon" data-v-ba8d1a1e></span><span data-v-ba8d1a1e>2025-08-25</span></p></div><!--]--><!--[--><!--]--><div class="_nosqldb_mongodb_nrb36ksw_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><h2 id="安装mongodb" tabindex="-1"><a class="header-anchor" href="#安装mongodb"><span>安装MongoDB</span></a></h2><h4 id="软件下载地址" tabindex="-1"><a class="header-anchor" href="#软件下载地址"><span>软件下载地址</span></a></h4><p>官网提供的软件下载地址：https://www.mongodb.com/try/download/community</p><p>在网页 “On-premises” 中，分别提供企业版和社区版。</p><ul><li>MongoDB-Enterprise-Server：收费的企业版</li><li>MongoDB-Community-Server：免费的社区版</li></ul><blockquote><p>MongoDB 近期强行修改了免费开源政策(主要针对云厂商)，企业版目前为收费版(所有云服务商提供的MongoDB产品都需要给他们交钱)，社区版为免费版。MongoDB企业版收费之后，会对MongoDB流行度会有一定的影响。</p></blockquote><p>根据操作系统，选择适合的版本和文件格式，并开始下载。</p><blockquote><p>点击下载之后网页会跳转到输入个人信息的页面，无需理会。<br> 大约3秒后，会自动开始下载刚才选择的软件安装包。<br> 目前最新稳定版本为 MongoDB 4.2.7</p></blockquote><h4 id="linux下安装mongodb" tabindex="-1"><a class="header-anchor" href="#linux下安装mongodb"><span>Linux下安装MongoDB</span></a></h4><p>本人的服务器为腾讯云 CentOS 7.6，所以下载时，Platform 这一项选择：RedHat/CentOS 7.0</p><h4 id="第一种安装方式-yum-安装" tabindex="-1"><a class="header-anchor" href="#第一种安装方式-yum-安装"><span>第一种安装方式：yum 安装</span></a></h4><p>咨询过腾讯技术人员，腾讯云 yum 默认安装的 MongDB 版本为2.6.12，由于版本过低，所以需要我们手工创建 yum源文件，以便自定义安装MongoDB的版本。</p><p><strong>第1步：使用 vim 命令创建 yum源文件</strong></p><p>文件保存路径为 /etc/yum.repos.d/mongodb-org-4.2.repo，文件内容为：</p><pre><code>[mongodb-org-4.2]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/7Server/mongodb-org/4.2/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-4.2.asc
</code></pre><blockquote><p>注意：<br> 上面代码baseurl中 “redhat/7Server/”，“7Server”对应本人的系统版本，你需要根据你的系统版本来修该值。</p></blockquote><blockquote><p>建议：</p><ol><li>不建议将 mongodb-org-4.2.repo 放到别的目录中，虽然没问题但也没什么意义。</li><li>本人根本不建议使用 yum安装，因为 yum 安装虽然简单，但也伴随着其他一些问题，例如我不希望yum自动升级该软件，或者我希望自定义 MongoDB 的安装目录等。</li></ol></blockquote><p><strong>第2步：执行安装命令</strong></p><pre><code>yum install -y mongodb-org
</code></pre><p>耐心等待，执行完成后即安装成功。</p><h4 id="第二种安装方式-tgz-安装" tabindex="-1"><a class="header-anchor" href="#第二种安装方式-tgz-安装"><span>第二种安装方式：.tgz 安装</span></a></h4><p><strong>第1步：在指定的目录中，下载 MongoDB对应的 .tgz 安装包</strong></p><p>目前最新版本文件安装包地址：https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.2.7.tgz</p><p>假设我希望将来 MongoDB 安装目录为系统根目录下的 /software/mongodb/，那么我可以先将 .tgz 文件下载到 software目录中。</p><ul><li>下载方法1：先下载该文件，然后通过 xftp 软件上传到服务器指定的目录中(例如根目录下的 software)</li><li>下载方法2：直接在服务器中，执行下面命令：</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>wget -P /software/ https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.2.7.tgz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>注意：<br> 如果你不确定服务器上是否安装 wget，可执行 rpm -qa|grep wget，若已安装会显示wget版本号。若未安装则执行 yum install -y wget 即可安装。</p></blockquote><p><strong>第2步：解压 .tgz 安装包</strong></p><p>cd 到 .tgz 下载目录(例如 /software/)，然后执行：</p><pre><code>tar -zxvf mongodb-linux-x86_64-rhel70-4.2.7.tgz  
</code></pre><p>解压即安装成功，MongoDB主程序就在 /software/mongodb-linux-x86_64-rhel70-4.2.7/bin/ 中。</p><p><strong>第3步：重命名</strong></p><p>默认MongoDB目录名字有点长，我们可以将其重命名，改为&quot;mongodb&quot;，进入 software 目录中，执行：</p><pre><code>mv mongodb-linux-x86_64-rhel70-4.2.7 mongodb
</code></pre><p>这样修改以后，目录名看着清爽简洁多了。</p><blockquote><p>当然你也可以完全忽略这一步，不进行重命名，这样目录名虽然有点长，但是版本标注的很清晰。</p></blockquote><p><strong>第4步：创建软连接</strong></p><p>执行：</p><pre><code>ln -s /software/mongodb/bin/* /usr/local/bin/
</code></pre><p>软连接创建好后，这样以后在任意目录，都可以执行 mongo 命令。</p><blockquote><p>注意：<br> 若你没有修改默认的 .tgz 解压后的目录名，则执行：</p></blockquote><pre><code>ln -s /software/mongodb-linux-x86_64-rhel70-4.2.7/bin/* /usr/local/bin/
</code></pre><p><strong>第5步：检测并连接 MongoDB</strong></p><p>任意目录执行：</p><pre><code>mongo
</code></pre><p>当看到：</p><pre><code>MongoDB shell version v4.2.7
connecting to: mongodb://127.0.0.1:27017/?compressors=disabled&amp;gssapiServiceName=mongodb
...
</code></pre><p>即表示 MongoDB 安装成功。</p><h4 id="windows下安装-仅限64位系统" tabindex="-1"><a class="header-anchor" href="#windows下安装-仅限64位系统"><span>Windows下安装(仅限64位系统)</span></a></h4><p>下载软件：https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2012plus-4.2.6-signed.msi<br> 安装软件：下一步 下一步，在倒数第2步界面左下角有一个选项“Install MongoDB Compass”，可以取消勾选，稍后单独安装 MongoDB Compass<br> 运行软件：安装完成后，找到 安装目录\MongoDB\Server\4.2\bin\mongo.exe，运行mongo.exe<br> 编写测试：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>var message = &#39;hello mongodb&#39;</span></span>
<span class="line"><span>pritejson(message)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：当MongoDB安装成功后，会默认自动创建3个数据库 admin、config、local 无需删除这3个，自己可以再新建别的数据库使用。</p><h4 id="安装mongodb-compass" tabindex="-1"><a class="header-anchor" href="#安装mongodb-compass"><span>安装MongoDB Compass：</span></a></h4><p>MongoDB Compass 是图形可视化管理MongoDB数据库的工具。若服务器系统为 CentOS 肯定就不用考虑安装这个了，因为服务器根本就没有图形化窗口，但是在 Windows 系统下，非常有必要安装这个软件。<br> 若在安装 MongoDB 过程中，没有同步安装 MongoDB Compass，需要手工下载并安装。<br> 下载软件：https://downloads.mongodb.com/compass/mongodb-compass-1.21.2-win32-x64.msi<br> 安装软件：下一步 下一步<br> 运行软件：运行MongoDBCompass.exe，进入软件后，先看完软件介绍后，点击继续按钮，即可看到当前本机MongoDB数据状态。</p><h4 id="mongod和mongo概念解释" tabindex="-1"><a class="header-anchor" href="#mongod和mongo概念解释"><span>mongod和mongo概念解释</span></a></h4><p>mongod 是 MongoDB 的服务程序，用来创建启动数据库；<br> mongo 是连接和操作 mongod 创建的数据库的工具；</p><h2 id="启动mongod" tabindex="-1"><a class="header-anchor" href="#启动mongod"><span>启动mongod</span></a></h2><p>推荐使用 配置文件(mongod.conf) 的方式启动 mongod。</p><p>Linux系统下启动：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>mongod -f mongod.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Windows系统下启动 (cmd命令窗口，右键，以管理员身份运行)：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>mongod.exe -f mongod.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>若不使用配置文件启动 mongod，采用直接 mongod + 参数 的形式，则需要输入多项对应的参数，略显麻烦。</p></blockquote><p>mongod.conf 配置参考：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>#数据库目录设置</span></span>
<span class="line"><span>storage:</span></span>
<span class="line"><span>  dbPath: ../data</span></span>
<span class="line"><span>  journal:</span></span>
<span class="line"><span>    enabled: true</span></span>
<span class="line"><span>    </span></span>
<span class="line"><span>#日志相关设置</span></span>
<span class="line"><span>systemLog:</span></span>
<span class="line"><span>  destination: file</span></span>
<span class="line"><span>  logAppend: true</span></span>
<span class="line"><span>  path:  ../log/mongod.log</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#网络端口设置</span></span>
<span class="line"><span>net:</span></span>
<span class="line"><span>  port: 27027</span></span>
<span class="line"><span>  bindIp: 127.0.0.1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#是否后台运行设置。 特别说明：windows系统不支持该项，不可以有此项设置</span></span>
<span class="line"><span>processManagement:</span></span>
<span class="line"><span>  fork: true</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#用户认证设置</span></span>
<span class="line"><span>security:</span></span>
<span class="line"><span>  authorization: enabled</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="windows系统启动-mongod-的注意事项" tabindex="-1"><a class="header-anchor" href="#windows系统启动-mongod-的注意事项"><span>Windows系统启动 mongod 的注意事项</span></a></h4><ol><li>可以使用 mongo.exe 直接连接 mongod所创建的数据库，但是直接运行 mongo.exe 连接时无法设置连接参数，例如端口为27017，无法设置账户密码等。如果 mongod 创建的数据库端口不是 27017，则 mongo.exe 连接失败，窗口会自动关闭，此时只能通过 cmd 命令窗口来连接。</li><li>windows系统命令窗口下执行 mongod -f mongod.conf 之后，即使成功启动，也不会有任何文字提示。</li><li>windows系统命令窗口不支持后台运行(fork:true)，因此 启动 mongod 之后，千万不要关闭当前 cmd 命令窗口，因为一旦关闭就相当于把 mongod 也关闭了。 想进行 mongo 命令连接 mongod，只能再新建一个 cmd 命令窗口进行操作。</li></ol><blockquote><p>特别注意：</p><ol><li>需要用 管理员账户 运行 cmd命令窗口</li><li>启动时，执行的代码是 <code>mongod.exe -f mongod.conf</code> ，一定要注意是 <code>mongod.exe</code></li></ol></blockquote><h4 id="结束mongod进程" tabindex="-1"><a class="header-anchor" href="#结束mongod进程"><span>结束mongod进程</span></a></h4><p>执行以下代码：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>killall -9 mongod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="mongodb优势" tabindex="-1"><a class="header-anchor" href="#mongodb优势"><span>MongoDB优势</span></a></h2><p>MongoDB以JSON文档形式储存数据。</p><p>以下笔记来源于：唐建法的《MongoDB高手课》视频教程</p><p>对于JSON而言：<br> 1、简单直观：以自然的方式来建模(自由定义数据模型)，以直观的方式与数据库交互(JSON与Object可直接相互转换)。<br> 2、结构灵活：弹性模式从容相应需求的频繁变化(不要求某集合中所有元素属性都必须一致)。<br> 3、快速开发：做更少的事，写更少的代码(可直接把数据以Object形式传递给数据库，而不像Mysql那样需要把一条数据中的各个属性拆分出来)。</p><p>不需要考虑错综复杂的关系模型、一目了然的对象模型。</p><p>对于开发人员而言：<br> 1、灵活：快速响应业务变化，具体表现为：</p><ul><li>多形性：同一个集合中可以包含不同字段(类型)的文档对象。即JSON的特性，例如允许某集合中前100名用户有一个属性，而100名以后的用户没有该属性。</li><li>动态性：线上修改数据模式，修改时应用和数据库均无需下线。 例如某集合所有数据由原来的每条10个属性增加到12个属性，这个操作可以直接在线上操作，无需让数据库先关停修改好后再上线。</li><li>数据治理：支持使用JSON Schema 来规范数据模式。在保证模式灵活动态的前提下，提供数据治理能力。 简单来说就是MongoDB也可以像Mysql那样对每个表(在MongoDB中叫集合)进行数据格式规范。</li></ul><p>2、快速：JSON模型的快速特性(数据库运行效率、程序员开发效率)</p><ul><li>数据库引擎只需要在一个存储区读写：相对Mysql需要建立多个关联表而言，MongoDB某一集合所有数据均在同一个存储区里。</li><li>反范式、无关联的组织极大优化查询速度：对于计算机而言，修改一条数据需要“定位和读写”，而“定位”和“读写”所需要消耗的性能占比，分别为95%和5%。 也就是说对于修改某条数据而言“定位”是最花费时间的。而Mysql通常为多表，不同表之间相互切换定位所花费时间会更多。最为关键的是开发者编写的代码，如果是Mysql需要编写多个表的操作代码，如果是MongoDB则直接操作一个集合即可。</li><li>程序API自然，开发快速：JSON非常接近程序员原本的对象操作方式，所以开发效率高。</li></ul><p>对于运维人员而言：<br> 1、原生的高可用和横向扩展能力：</p><ul><li>节点 复制集(Replica Set)数量可以是2-50个，默认安装为3个(1个Primary和2个Secondary)</li><li>自动恢复，若主节点发生故障，从节点可自动恢复替换主节点。</li><li>支持多中心部署，多中心容灾，数据同步。</li><li>滚动服务。 例如先只修改其中一个副节点，然后通过 MongoDB复制集 的方式将其他节点都进行修改，从而实现数据库不下线的情况下进行数据库改造升级。</li></ul><p>2、横向扩展能力：</p><ul><li>通过分片集群，可以无缝扩展</li><li>应用全透明</li><li>多种数据分布策略</li><li>轻松支持TB-PB数量级</li></ul><p>MongoDB技术优势总结：<br> 1、JSON结构和对象模型接近、开发代码量低<br> 2、JSON的动态模型意味着更容易响应新的业务变化需求<br> 3、复制集提供高可用<br> 4、分片架构支持海量数据和无缝扩容</p><h2 id="mongodb-数据库和集合-相关知识" tabindex="-1"><a class="header-anchor" href="#mongodb-数据库和集合-相关知识"><span>MongoDB 数据库和集合 相关知识</span></a></h2><h4 id="数据结构" tabindex="-1"><a class="header-anchor" href="#数据结构"><span>数据结构</span></a></h4><p>MongoDB数据结构为：<br> 1、MongoDB下面有若干个数据库(db)<br> 2、每个数据库下有若干个集合(collection)<br> 3、每个集合里储存若干个文档(JSON格式的数据)<br> 即：dbs -&gt; db -&gt; collection -&gt; JSON document</p><p>因此，如果想操作某条数据(增删改查)，正确的流程是：<br> 1、先使用 use xxx 切换到该数据库<br> 2、明确要修改的集合名字 db.xx<br> 3、再使用具体的增删改查函数进行操作</p><p>举例：假设moodmap数据库中的user集合要新增一条数据，对应的执行命令为：<br> 1、use moodmap 切换到moodmap数据库<br> 2、db.user.insert({&#39;name&#39;:&#39;puxiao&#39;}) db.user表示要修改的集合名字为user，insert()为添加数据的函数</p><p>请注意：不可以直接给某数据库添加数据，只能给该数据库下某集合添加数据。</p><h4 id="基础知识" tabindex="-1"><a class="header-anchor" href="#基础知识"><span>基础知识</span></a></h4><p>1、当MongoDB安装成功后，会自动创建3个数据库 admin、config、local<br> 2、与此同时MongoDB还会隐形存在一个数据库 test。若未切换到某具体的数据库，此时若执行向某集合中添加数据命令，那么MongoDB会启用一个名为 test 的数据库，并把数据添加到 test 中。基于这个原因，你自己创建数据库时切忌不要使用 test 来当数据库名字。<br> 3、如果只创建但是从未添加过数据，则该数据库不会在 MongoDB Compass中出现，使用 use dbs 查看全部数据库也看不到。就好像默认的 test数据库最开始是不显示的，只有在未指定数据库前提下进行某集合数据添加后，MongoDB把这条添加的数据归类到test中，此时 test 数据库才可以被查看到。<br> 4、在MongoDB的shell命令中，属性名是可以不加引号的，属性值需要加引号，既可以是单引号也可以是双引号。如果属性值是数字，则可不加引号。</p><h4 id="开启、查看、关闭数据库" tabindex="-1"><a class="header-anchor" href="#开启、查看、关闭数据库"><span>开启、查看、关闭数据库</span></a></h4><p>开启某数据库：use xxx<br> 查看当前所在数据库：db<br> 查看全部数据库：show dbs<br> 关闭当前数据库：db.shutdownServer() 此为优雅关闭数据库的方式，即数据库先把当前全部认为执行完毕后才真正关闭数据库</p><h4 id="查看集合" tabindex="-1"><a class="header-anchor" href="#查看集合"><span>查看集合</span></a></h4><p>查看当前所在数据库中的所有集合：show collections 打印出所有集合名字<br> 返回当前所有数据库中集合名字：db.getCollectionNames() 将所有集合名字以数组形式返回</p><h4 id="配置数据库" tabindex="-1"><a class="header-anchor" href="#配置数据库"><span>配置数据库</span></a></h4><p>配置端口：--port xxxx<br> 以进程守护方式启动：--fork<br> 日志输出路径：--loppath xxxx<br> 数据库路径：--dbpath xxxx<br> 启动代码示例：mongodb --port 27017 --fork --logpath data/log/mongodb.log --dbpath data/db</p><h4 id="创建或切换数据库" tabindex="-1"><a class="header-anchor" href="#创建或切换数据库"><span>创建或切换数据库</span></a></h4><p>命令代码：use xxx<br> 详细说明：<br> 1、创建或切换数据库语法关键词：use<br> 2、xxx 即要创建或切换的数据库名字<br> 3、若数据库不存在，MongoDB则会创建名为xxx的数据库并切换到该数据库<br> 4、若数据库已存在，则切换到该数据库<br> 5、也就是说：无论新创建或是本身已存在，执行use xxx 后都会自动切换到该数据库</p><p>例如，创建数据库moodmap：use moodmap<br> 若没有moodmap数据库则会创建，若moodmap已存在则切换到该数据库，命令面板会提示：switched to db moodmap</p><p>再次提醒：若数据库没有任何内容，则使用 use dbs 是不会出现的。 就好像上面代码中 执行 use moodmap 创建新的数据库，此时执行 use dbs，moodmap是不会出现在结果列表中的。</p><h4 id="删除数据库或集合" tabindex="-1"><a class="header-anchor" href="#删除数据库或集合"><span>删除数据库或集合</span></a></h4><p>删除数据库<br> 命令代码：db.dropDatabase()<br> 详细说明： 1、删除数据库是危险操作，需要谨慎<br> 2、首先需要确认删除哪个数据库，可以切换到该数据库，例如 use moodmap 或者 查看当前所在数据库 db<br> 3、执行db.dropDatabase() 即可删除该数据库</p><p>删除集合<br> 命令代码：db.collection.drop()</p><h4 id="重命名-数据库或集合" tabindex="-1"><a class="header-anchor" href="#重命名-数据库或集合"><span>重命名 数据库或集合</span></a></h4><p>MongoDB并未提供直接函数可以重命名数据库，但是有针对集合的重命名函数renameCollection()</p><p>针对集合的重命名<br> 命令代码：db.adminCommand({renameCollection:&quot;dbname.oldname&quot;,to:&quot;dbname.newname&quot;})<br> 详细说明：<br> 1、&quot;dbname&quot;为当前数据库的名字<br> 2、&quot;dbname.oldname&quot;为某集合的当前名字，&quot;dbname.newname&quot;为某集合新的名字<br> 例如 db.adminCommand({renameCollection:&quot;moodmap.user&quot;,to:&quot;moodmap.users&quot;})，将数据库moodmap中集合user名字改为users</p><p>2、不光可以修改集合名，还可以修改集合对应的数据库名 dbname<br> 例如 db.adminCommand({renameCollection:&quot;moodmap.user&quot;,to:&quot;mymap.user&quot;})，将数据库moodmap中的集合user 转移到 数据库mymap中的集合user。</p><p>注意：这种“转移”属于“修改元数据”，是对索引的修改，并不会真正重新复制出一份，因此这种修改消耗很小。</p><p>修改集合对应的数据库，存在以下几种结果：<br> 1、若mymap.user本身就存在，则会转移失败，反之则会成功。<br> 2、若mymap本身不存在，则会自动创建mymap。<br> 3、若moodmap里面只有user 一个集合，那么转移成功后 moodmap 即为空数据库，那么此时 show dbs 或在 MongoDB Compass中将无法再看到 moodmap。</p><p>基于上面对于某数据库中的集合重命名操作，我们可以变相实现对数据库的重命名。<br> 假设当前数据库为moodmap，我们希望将数据库重命名为mymap。<br> 实施思路：将moodmap中所有的集合都通过重命名形式，转移到mymap中，这样moodmap为空数据库则会消失(use dbs 或在 MongoDB Compass中消失)，而新的数据库mymap总拥有原moodmap所有集合，变相实现将moodmap重命名为mymap。</p><p>示例代码：</p><pre><code>let source = &quot;source&quot;;
let dest = &quot;dest&quot;;
let colls = db.getSiblingDB(source).getCollectionNames();
for (let i = 0; i&lt;colls.length; i++) {
  let from = `${source}.${colls[i]}`;
  let to = `${dest}.${colls[i]}`;
  db.adminCommand({renameCollection: from, to: to});
}
</code></pre><p>备注：MongoDB 4.2 支持ES6中的新语法，例如 let 和 模板字符串</p><h2 id="增删改查-相关知识" tabindex="-1"><a class="header-anchor" href="#增删改查-相关知识"><span>增删改查 相关知识</span></a></h2><p>对数据库进行 增删改查，例如“添加数据”准确含义为“向某数据库中的某个集合中添加JSON文档类型的数据”。</p><h4 id="添加数据" tabindex="-1"><a class="header-anchor" href="#添加数据"><span>添加数据</span></a></h4><p>命令代码：db.xxx.insert(json)<br> 详细说明：<br> 1、添加数据语法关键词：insert<br> 2、json即要添加的数据，格式为JSON<br> 3、若要添加多条数据，则可使用数据，例如：[json1,json2]<br> 4、添加时MongoDB会自动为该条数据添加 _id 的属性值。<br> 5、若不想使用MongoDB默认的_id值，需要提前在json数据中心设定 _id属性。</p><p>特别强调：<br> 1、若我们向db.xxx添加数据时，db.xxx根本不存在，MongoDB会自动为我们创建 xxx 这个集合。<br> 2、对于比较新的MongoDB版本，可以使用insertOne(json)和insertMany([json1,json2,...])来分别添加1条或多条数据。</p><h4 id="查找数据" tabindex="-1"><a class="header-anchor" href="#查找数据"><span>查找数据</span></a></h4><p>命令代码：db.xxx.find({})<br> 详细说明：<br> 1、查找数据语法关键词：find<br> 2、{}为查找条件</p><ul><li>db.xxx.find() 参数为空，则表示条件不限，查找全部</li><li>{} 空对象，则表示条件不限，查找全部</li><li>{name:&#39;puxiao&#39;} 包含某属性值得JSON对象，则表示查找name为‘puxiao’的数据</li></ul><h4 id="条件比较查询" tabindex="-1"><a class="header-anchor" href="#条件比较查询"><span>条件比较查询</span></a></h4><p>命令代码：db.xxx.find({age:{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#39;EOF&#39;, got &#39;}&#39; at position 9: xx:value}̲})
详细说明：  
1、满足…" style="color:#cc0000;">xx:value}}) 详细说明： 1、满足对比条件才可以被查询到 2、</span>xx:value中 $xx为比较计算的类型，value为比较的对象值</p><p>$xx 对应含义：</p><ul><li>$gt 存在并大于</li><li>$gte 存在并大于等于</li><li>$lt 存在并小于</li><li>$lte 存在并小于等于</li><li>$eq 存在并等于</li><li>$ne 不存在 或 存在并不等于</li><li>$in 存在并在指定数组中</li><li>$nin 不存在 或 存在但不在指定数组中</li><li>$exists:false 不存在(未定义)</li><li>$exists:true 存在(有定义)</li></ul><h4 id="多条件查询" tabindex="-1"><a class="header-anchor" href="#多条件查询"><span>多条件查询</span></a></h4><p>and条件查询<br> 命令代码：db.xxx.find({name:&#39;puxiao&#39;,age:18}) 或 db.xxx.find($and:[{name:&#39;puxiao&#39;},{age:18}])<br> 详细说明：<br> 1、多个条件(属性值)必须同时满足才可以被查询到</p><p>or条件查询<br> 命令代码：db.xxx.find(<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#39;}&#39;, got &#39;EOF&#39; at end of input: …puxiao&#39;},{age:{" style="color:#cc0000;">or:[{name:&#39;puxiao&#39;},{age:{</span>lt:30}}]) 详细说明：<br> 1、只要有1个条件(属性值)满足要求即可被查询到</p><h4 id="使用正则表达式查询" tabindex="-1"><a class="header-anchor" href="#使用正则表达式查询"><span>使用正则表达式查询</span></a></h4><p>命令代码：db.xxx.find({name:/xxxxx/})<br> 详细说明：<br> 1、/xxxxx/ 为一个正则表达式，只要满足该表达式的值都可以被查询到。<br> 举例：db.xxx.find({name:/^p/}) 查找属性name值是以p为开头的数据</p><h4 id="针对子文档进行查询" tabindex="-1"><a class="header-anchor" href="#针对子文档进行查询"><span>针对子文档进行查询</span></a></h4><p>所谓子文档值：JSON文档数据中某属性值依然为一个JSON对象。</p><p>例如使用下面命令插入一条数据： db.mood.insert({type:&#39;happy&#39;,why:{wealth:&#39;500w&#39;,wife:&#39;beautiful&#39;}})<br> 其中属性why的值也是一个JSON文档，那么why就是这条数据的子文档。</p><p>针对子文档里的数据查询，使用命令代码：<br> db.mood.find({&#39;why.wealth&#39;:&#39;500w&#39;})</p><p>请注意：上述代码中属性名为 &#39;why.wealth&#39;，即表示 mood集合下属性why下的子文档属性wealth</p><h4 id="针对子文档-多条件多字段查询" tabindex="-1"><a class="header-anchor" href="#针对子文档-多条件多字段查询"><span>针对子文档 多条件多字段查询</span></a></h4><p>命令代码：db.xxx.find({&#39;why.wealth&#39;:&#39;500w&#39;,&#39;why.wife&#39;:&#39;beautiful&#39;})<br> 可写成另外一种形式：<br> db.xxx.find({&#39;why&#39;:{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#39;EOF&#39;, got &#39;}&#39; at position 43: …fe:&#39;beautiful&#39;}}̲})  
详细说明：  
1、" style="color:#cc0000;">elemMatch:{wealth:&#39;500w&#39;,wife:&#39;beautiful&#39;}}}) 详细说明： 1、</span>elemMatch 为关键词，表示必须全部满足</p><h4 id="获取属性值" tabindex="-1"><a class="header-anchor" href="#获取属性值"><span>获取属性值</span></a></h4><p>命令代码：&#39;$xxx&quot;<br> 详细说明：<br> 1、假设有一条数据为 {&quot;name&quot;:&quot;puxiao&quot;,&quot;age&quot;:34}，那么 &#39;age&#39; 表示属性名，属性名前面加上 $ 即表示属性值，例如 &#39;$age&#39; 表示age的属性值。</p><h4 id="遍历游标" tabindex="-1"><a class="header-anchor" href="#遍历游标"><span>遍历游标</span></a></h4><p>命令代码：xxx.hasNext()、xxx.next()<br> 详细说明：<br> 1、声明 xxx 为某个查询结果<br> 2、可通过 while(xxx.hasNext()){xxx.next()} 来循环遍历查询结果 3、hasNext()即表示‘是否还有下一个’<br> 4、next()即表示‘将游标切换到下一个’</p><h4 id="查询修饰符" tabindex="-1"><a class="header-anchor" href="#查询修饰符"><span>查询修饰符</span></a></h4><p>命令代码：limit(num)、sort({name:-1|1})<br> 详细说明： limit(num) 用来限定返回结果数量，例如limit(10)表示最多返回10条结果即可。<br> 举例：db.xx.find({}).limit(10)</p><p>sort({xxx:-1}) 用来设定按降序排序，如果是sort({xxx:1})则表示按升序排序。<br> 举例：db.xx.find({}).sort({age:-1}) 按属性age的降序排序</p><h4 id="查询结果统计" tabindex="-1"><a class="header-anchor" href="#查询结果统计"><span>查询结果统计</span></a></h4><p>命令代码：db.xxx.find({}).count()<br> 详细说明：使用count()函数可对结果数量进行统计</p><h4 id="控制查询返回结果" tabindex="-1"><a class="header-anchor" href="#控制查询返回结果"><span>控制查询返回结果</span></a></h4><p>命令代码：db.xxx.find({},{_id:0,name:1})<br> 详细说明：<br> 1、在find()函数中添加第2个参数，该参数为一个JSON对象<br> 2、若属性值为1，表示可以返回该属性名和属性值<br> 3、若属性值为0，表示不返回该属性名和属性值<br> 4、由于默认一定会返回_id，所以若不需要返回_id则需要显式声明 _id:0<br> 5、没有提及的属性名，均不会返回</p><p>限定返回字段这个在MongoDB里被称为 投影(projection)。</p><h4 id="格式化输出打印结果" tabindex="-1"><a class="header-anchor" href="#格式化输出打印结果"><span>格式化输出打印结果</span></a></h4><p>命令代码：pretty()<br> 详细说明：<br> 1、在查找命令结尾处，添加.pretty()即可格式化输出打印结果</p><p>例如：db.xxx.find().pretty()</p><h4 id="删除数据" tabindex="-1"><a class="header-anchor" href="#删除数据"><span>删除数据</span></a></h4><p>命令代码：db.xxx.remove(json)<br> 详细说明：<br> 1、删除数据语法关键词：remove<br> 2、json为我们要删除对象的条件 3、删除对象的条件和查找数据的条件，语法一模一样</p><ul><li>db.xxx.remove() 参数为空，运行则会报错</li><li>{} 删除所有数据</li><li>{age:28} 删除所有属性age值为28的数据</li><li>{age:{$lt:18}) 删除所有属性age值小于18的数据</li></ul><p>注意：删除默认是‘批量多条’的操作行为。</p><h4 id="更新数据" tabindex="-1"><a class="header-anchor" href="#更新数据"><span>更新数据</span></a></h4><p>命令代码：db.xxx.update(json,{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#39;EOF&#39;, got &#39;}&#39; at position 10: set:json2}̲,{xx})  
详细说明： …" style="color:#cc0000;">set:json2},{xx}) 详细说明： 1、update()函数有2个必填参数和1个可选参数 2、第1、第2个参数为必填，第3个参数为可选参数 3、第1个参数为查询条件 4、第2个参数为需要修改的属性与值，格式需要遵循 {</span>set:{&#39;xx&#39;:value}} 的格式。若不使用$set:而是第2个参数直接为{&#39;xx&#39;:value}，那么意味着直接整体覆盖。<br> 5、第3个参数为可选参数，为更新选项设置</p><p>举例：db.xxx.update({age:18},{$set:{&#39;age&#39;:34}}) 将属性age值为18的数据修改为age值为34</p><p>第3个更新选项配置，一共有3个属性，分别是：</p><ul><li>upsert 当原本不存在要修改对象时是否添加该对象，默认为false，即不添加。请注意这里说的是 对象不存在，而不是对象属性不存在</li><li>multi 是否为更新多条数据，默认为false，即只更新1条</li></ul><p>举例：db.xxx.update({age:18},{$set:{&#39;age&#39;:34}},{multi:true}) 查找属性age值为18的数据，并将他们的属性age值全部修改为34</p><p>如果要同时修改多条数据，除了设置第3个参数multi为true之外，还可通过使用db.xxx.updateMany()。</p><p>对于insertOne()和insertMany()来说，函数中必须使用到以下关键词之一，若不使用则会报错：<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>t</mi><mtext>如果匹配到，则设置该值</mtext></mrow><annotation encoding="application/x-tex">set 如果匹配到，则 设置该值 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">se</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">如果匹配到，则设置该值</span></span></span></span>unset 如果匹配到，则删除该属性<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>u</mi><mi>s</mi><mi>h</mi><mtext>如果匹配到，则添加一个值到数组结尾</mtext></mrow><annotation encoding="application/x-tex">push 如果匹配到，则 添加一个值到数组结尾 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord cjk_fallback">如果匹配到，则添加一个值到数组结尾</span></span></span></span>pushall 如果匹配到，则 添加多个值到数组结尾<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>p</mi><mtext>如果匹配到，则从数组结尾处剔除一个值</mtext></mrow><annotation encoding="application/x-tex">pop 如果匹配到，则 从数组结尾处剔除一个值 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">如果匹配到，则从数组结尾处剔除一个值</span></span></span></span>pull 如果匹配到，则 从数组中删除一个值<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>u</mi><mi>l</mi><mi>l</mi><mi>a</mi><mi>l</mi><mi>l</mi><mtext>如果匹配到，则从数组中删除全部对应的值</mtext></mrow><annotation encoding="application/x-tex">pullall 如果匹配到，则 从数组中删除全部对应的值 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord cjk_fallback">如果匹配到，则从数组中删除全部对应的值</span></span></span></span>addToSet 如果不存在则增加一个值到数组</p><h4 id="添加或更新数据" tabindex="-1"><a class="header-anchor" href="#添加或更新数据"><span>添加或更新数据</span></a></h4><p>命令代码：db.xxx.save(json)<br> 详细说明：<br> 1、json表示一个JSON格式的文档数据<br> 2、若json中没有_id属性，则插入该条数据<br> 3、若json中有_id属性，则会通过_id查找是否存在该_id的数据<br> 4、若_id对应的数据原本存在，则将json完全替换原来数据<br> 5、若_id对应的数据原本不存在，则插入该条数据，但是该数据的_id不再使用MongoDB默认的，而是使用json本身中的_id属性值</p><p>以上为MongoDB基础用法，接下来才会真正触及MongodDB真正核心，高级用法：聚合查询</p><h2 id="聚合查询" tabindex="-1"><a class="header-anchor" href="#聚合查询"><span>聚合查询</span></a></h2><h4 id="什么是mongodb聚合查询" tabindex="-1"><a class="header-anchor" href="#什么是mongodb聚合查询"><span>什么是MongoDB聚合查询？</span></a></h4><p>MongoDB聚合框架(Aggregation Framework)是一个计算框架，可以作用在一个或几个集合中，对集合中的数据进行一系列运算，并将运算结果转化为期望的形式。这种多集合、多维度、多条件、多形式、多组合的查询方式就称为聚合查询。</p><p>注意：聚合查询也称为聚合运算，名字不同但是表示的是同一个意思。</p><p>补充说明：<br> 1、像db.xxx.find(query) 这种只是针对单一集合进行一些条件查询，并返回原始数据的，可以称之为“最简单基础的查询”<br> 2、像db.xxx.find(query).sort(xxx) 或 db.xxx.find(query).limit(10) 针对查询结果又进行了处理，例如排序或只获取限定数量的查询，姑且称之为“稍微复杂点的查询”<br> 3、而聚合查询则是设定多项查询条件、逐层筛检、累计运算、设定返回结果格式的，就可以称之为“比较复杂的查询”。现实中项目开发肯定使用最多的还是聚合查询。</p><p>举例：假设有一个数据库存放全班学生的数学考试成绩<br> 1、使用db.xxx.find()可以查找出所有人的数学成绩<br> 2、使用db.xxx.find().sort()可以列出所有人的数学成绩排名<br> 3、若此时想查询所有学生的数学平均成绩，平均成绩这个字段原本是不存在的，此时就需要通过聚合查询，计算并返回出平均成绩。</p><h4 id="管道-pipeline-和步骤-stage" tabindex="-1"><a class="header-anchor" href="#管道-pipeline-和步骤-stage"><span>管道(pipeline)和步骤(stage)</span></a></h4><p>聚合查询(聚合运算)的整个查询(运算)过程称为管道，查询(运算)过程由多个步骤组成。</p><p>聚合查询整个过程是： 1、从第一个步骤开始，计算得到结果<br> 2、从第一个结果开始，进行第二个步骤，并得到第二步骤的结果<br> 3、依次类推，直到最后一个步骤计算完成<br> 4、将最终的计算结果返回给查询主体</p><p>原始数据 -&gt; 步骤1 -&gt; 结果1 -&gt; 步骤2 -&gt; 结果2 -&gt; ... -&gt; 最终结果</p><p>数据结果就好像是水，流经一个又一个管道，经过每个管道的过滤，最终剩下的水到达目标出口。</p><h4 id="聚合查询基础格式" tabindex="-1"><a class="header-anchor" href="#聚合查询基础格式"><span>聚合查询基础格式</span></a></h4><p>命令代码：db.xxx.aggregate([stage1,stage2,...],{options})<br> 详细说明： 1、聚合查询使用关键词 aggregate<br> 2、aggregate函数共2个参数<br> 3、第1个参数为一个数组，数组中每一项均代表一个查询运算步骤<br> 4、第2个参数为一个对象，是查询运算的配置选项</p><h4 id="常见查询运算步骤" tabindex="-1"><a class="header-anchor" href="#常见查询运算步骤"><span>常见查询运算步骤</span></a></h4><ul><li>$sort 排序</li><li>$limit 限定返回结果数量</li><li>$unwind 将某个数组拆分成独立的元素(类似JS中的...array)</li><li>$match 过滤数据，必须全部满足条件</li><li>$skip 跳过指定数量，返回剩余的结果</li><li>$group 将集合中的文档分组，可用于统计结果</li><li>$project 修改输出的文档解构，可以重命名、增加、删除域，也可以创建计算结果</li><li>$geoNear 输出接近某一地理位置的有序文档</li><li>$lookup 多表关联操作</li></ul><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mtext>、</mtext></mrow><annotation encoding="application/x-tex">match、</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord cjk_fallback">、</span></span></span></span>project、$group 这3个是常见的、核心的、包裹其他查询的运算符。</p><h4 id="特有步骤-facet" tabindex="-1"><a class="header-anchor" href="#特有步骤-facet"><span>特有步骤 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>u</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>t</mi><mtext>和</mtext></mrow><annotation encoding="application/x-tex">bucket和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">和</span></span></span></span>facet</span></a></h4><p>$bucket这个步骤可用于将数据按照某一种维度自动分组查询。常见的应用场景是搜索商品时，按不同价格区间进行查询。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>a</mi><mi>c</mi><mi>e</mi><mi>t</mi><mtext>这个步骤是将多组</mtext></mrow><annotation encoding="application/x-tex">facet这个步骤是将多组</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">这个步骤是将多组</span></span></span></span>bucket进行查询，从而实现多维度查询。例如搜索商品时，按不同价格区间、不同品牌、不同类型等多维度分组查询。</p><h2 id="更多api详情" tabindex="-1"><a class="header-anchor" href="#更多api详情"><span>更多API详情</span></a></h2><p>MongoDB全部API请访问：https://docs.mongodb.com/manual/reference/</p><p>补充：无论是MongoDB中文网(https://www.mongodb.org.cn/) 还是 MongoDB中文社区(https://mongoing.com/) ，他们上面关于MongoDB的中文API文档都存在版本比较滞后、不是最新、不够全面的问题。<br> 因此学习时，还是以英文官方API文档为好。</p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-fda6bbae><!--[--><!--]--><!----><!----><nav class="prev-next" data-v-fda6bbae><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link prev" href="/lema/nosqldb/z5tlt4gj/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>上一页</span><span class="title" data-v-fda6bbae>Redis实战练习</span><!--]--><!----></a></div><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link next" href="/lema/nosqldb/mongodb/p418al5x/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>下一页</span><span class="title" data-v-fda6bbae>MongoDB聚合查询</span><!--]--><!----></a></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-23f6ad98><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-d90a7a26 data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-d90a7a26 data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>快程乐码| Copyright © 2025 乐码职说 | 苏ICP备2024062796号-1</p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/lema/assets/app-ZQgO6-gU.js" defer></script></body></html>