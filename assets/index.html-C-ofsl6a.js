import{a as i,c as a,b as e,o as l}from"./app-ZQgO6-gU.js";const n={};function h(t,s){return l(),a("div",null,s[0]||(s[0]=[e(`<p>索引是加速搜索引擎检索数据的一种特殊表查询。简单地说，索引是一个指向表中数据的指针。一个数据库中的索引与一本书的索引目录是非常相似的。</p><p>拿汉语字典的目录页（索引）打比方，我们可以按拼音、笔画、偏旁部首等排序的目录（索引）快速查找到需要的字。</p><p>索引有助于加快 SELECT 查询和 WHERE 子句，但它会减慢使用 UPDATE 和 INSERT 语句时的数据输入。索引可以创建或删除，但不会影响数据。</p><p>使用 CREATE INDEX 语句创建索引，它允许命名索引，指定表及要索引的一列或多列，并指示索引是升序排列还是降序排列。</p><p>索引也可以是唯一的，与 UNIQUE 约束类似，在列上或列组合上防止重复条目。</p><h2 id="_1-1-create-index-命令" tabindex="-1"><a class="header-anchor" href="#_1-1-create-index-命令"><span>1.1 CREATE INDEX 命令</span></a></h2><p>CREATE INDEX （创建索引）的语法如下：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX index_name </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_1-2-索引类型" tabindex="-1"><a class="header-anchor" href="#_1-2-索引类型"><span>1.2 索引类型</span></a></h2><h3 id="_1-2-1-单列索引" tabindex="-1"><a class="header-anchor" href="#_1-2-1-单列索引"><span>1.2.1 单列索引</span></a></h3><p>单列索引是一个只基于表的一个列上创建的索引，基本语法如下：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX index_name</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name (column_name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-2-组合索" tabindex="-1"><a class="header-anchor" href="#_1-2-2-组合索"><span>1.2.2 组合索</span></a></h3><p>组合索引是基于表的多列上创建的索引，基本语法如下：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX index_name</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name (column1_name, column2_name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>不管是单列索引还是组合索引，该索引必须是在 WHEHE 子句的过滤条件中使用非常频繁的列。</p><p>如果只有一列被使用到，就选择单列索引，如果有多列就使用组合索引。</p><h3 id="_1-2-3-唯一索引" tabindex="-1"><a class="header-anchor" href="#_1-2-3-唯一索引"><span>1.2.3 唯一索引</span></a></h3><p>使用唯一索引不仅是为了性能，同时也为了数据的完整性。唯一索引不允许任何重复的值插入到表中。基本语法如下：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> UNIQUE INDEX</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> index_name</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">on</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name (column_name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-4-局部索引" tabindex="-1"><a class="header-anchor" href="#_1-2-4-局部索引"><span>1.2.4 局部索引</span></a></h3><p>局部索引 是在表的子集上构建的索引；子集由一个条件表达式上定义。索引只包含满足条件的行。基础语法如下：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX index_name</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">on</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name (conditional_expression);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-5-隐式索引" tabindex="-1"><a class="header-anchor" href="#_1-2-5-隐式索引"><span>1.2.5 隐式索引</span></a></h3><p>隐式索引 是在创建对象时，由数据库服务器自动创建的索引。索引自动创建为主键约束和唯一约束。</p><h2 id="_1-3-实例" tabindex="-1"><a class="header-anchor" href="#_1-3-实例"><span>1.3 实例</span></a></h2><p>下面实例将在 COMPANY 表的 SALARY 列上创建索引：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># CREATE INDEX salary_index </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> COMPANY (salary);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>现在，用 <strong>\\d company</strong> 命令列出 COMPANY 表的所有索引：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># \\d company</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>得到的结果如下，company_pkey 是隐式索引 ，是表创建表时创建的：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">runoobdb</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># \\d company</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                  Table</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> &quot;public.company&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> Column</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  |     </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Type</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">      | Collation | Nullable | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Default</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">---------+---------------+-----------+----------+---------</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> id      | </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">integer</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">       |           | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">not</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> null</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    | text          |           | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">not</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> null</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age     | </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">integer</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">       |           | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">not</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> null</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> address | character(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">50</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) |           |          | </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary  | real          |           |          | </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Indexes:</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    &quot;company_pkey&quot;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> PRIMARY KEY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, btree (id)</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    &quot;salary_index&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> btree (salary)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你可以使用 \\di 命令列出数据库中所有索引：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">runoobdb</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># \\di</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                    List </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">of</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> relations</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Schema |      </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">       | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Type</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  |  Owner   |   </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Table</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">--------+-----------------+-------+----------+------------</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> public | company_pkey    | index | postgres | company</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> public | department_pkey | index | postgres | department</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> public | salary_index    | index | postgres | company</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> rows)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-4-drop-index-删除索引" tabindex="-1"><a class="header-anchor" href="#_1-4-drop-index-删除索引"><span>1.4 DROP INDEX （删除索引）</span></a></h2><p>一个索引可以使用 PostgreSQL 的 DROP 命令删除。</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DROP</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX index_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>您可以使用下面的语句来删除之前创建的索引：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DROP</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INDEX salary_index;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>删除后，可以看到 salary_index 已经在索引的列表中被删除：</p><div class="language-plsql line-numbers-mode" data-highlighter="shiki" data-ext="plsql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plsql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">runoobdb</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"># \\di</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                    List </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">of</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> relations</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Schema |      </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">       | </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Type</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  |  Owner   |   </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Table</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">--------+-----------------+-------+----------+------------</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> public | company_pkey    | index | postgres | company</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> public | department_pkey | index | postgres | department</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> rows)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-5-什么情况下要避免使用索引" tabindex="-1"><a class="header-anchor" href="#_1-5-什么情况下要避免使用索引"><span>1.5 什么情况下要避免使用索引？</span></a></h2><p>虽然索引的目的在于提高数据库的性能，但这里有几个情况需要避免使用索引。</p><p>使用索引时，需要考虑下列准则：</p><ul><li>索引不应该使用在较小的表上。</li><li>索引不应该使用在有频繁的大批量的更新或插入操作的表上。</li><li>索引不应该使用在含有大量的 NULL 值的列上。</li><li>索引不应该使用在频繁操作的列上。</li></ul>`,45)]))}const d=i(n,[["render",h]]),k=JSON.parse('{"path":"/PostgreSQL/vogxe5ya/","title":"PostgreSQL索引","lang":"zh-CN","frontmatter":{"title":"PostgreSQL索引","createTime":"2025/08/26 15:13:11","permalink":"/PostgreSQL/vogxe5ya/"},"readingTime":{"minutes":3.17,"words":951},"git":{"createdTime":1756736713000},"filePathRelative":"notes/PostgreSQL/PostgreSQL索引.md","headers":[]}');export{d as comp,k as data};
